<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.3/dropzone.min.js"></script>
  <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}">
  <script th:inline="javascript">
    const equals = /*[[${equals}]]*/ '';
      if (equals == false) {
          alert("권한이 없습니다");
          history.back();
      }
  </script>
</head>
<body>
<div th:replace="fragment/header :: header"></div>
<div th:replace="fragment/nav :: nav"></div>
<main class="container mt-5 pt-3">
  <div th:include="main/notice/modifymain :: modifymain"></div>
</main>
<div th:replace="fragment/footer :: footer"></div>
<div th:text = "${file}"></div>
<script th:src="@{/js/notice/noticemodify.js}"></script>
<script th:inline="javascript">
  Dropzone.autoDiscover = false;
  var myDropzone = new Dropzone("#fileDropzone", {
    url: '/noticemodify_proc', // URL이 올바르게 설정되었는지 확인
    autoProcessQueue: false,
    maxFilesize: 10, // 파일 크기 제한 (MB)
    dictDefaultMessage: "여기를 클릭하거나 파일을 마우스로 끌어오세요",
    paramName: "ofile", // 파일 이름 매핑
    maxFiles: 5, // 최대 파일 개수
    addRemoveLinks: true, // 파일 제거 링크 추가
    dictFileTooBig: "파일 크기가 너무 큽니다. 최대 크기는 10MB입니다."
});

document.addEventListener("DOMContentLoaded", () => {
    // 파일 목록 가져오기
    var files = JSON.parse(/*[[${file}]]*/ '[]');
    console.log("Rendered files:", files);

    // 파일 추가
    files.forEach(function(fileInfo) {
        console.log("Original Filename: " + fileInfo.ofile);
        console.log("Stored Filename: " + fileInfo.sfile);
        let mockFile = { name: fileInfo.ofile, size: 12345 }; // 가상의 파일 객체 생성
        myDropzone.emit("addedfile", mockFile); // Dropzone에 파일 추가
        let filePath = `/uploads/${fileInfo.sfile}`;
        myDropzone.emit("complete", mockFile); // 파일이 완전히 업로드된 상태로 표시
    });
});
</script>


</body>
</html>